<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>howto/sftp-best-practice · eMagiz Platform documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="# Best practices for using SFTP"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="howto/sftp-best-practice · eMagiz Platform documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://emagiz.github.io/"/><meta property="og:description" content="# Best practices for using SFTP"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/platypus.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/platypus.png" alt="eMagiz Platform documentation"/><h2 class="headerTitleWithLogo">eMagiz Platform documentation</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Ask me something" title="Ask me something"/></li><li class=""><a href="/docs/referenceguide/" target="_self">Reference Guide</a></li><li class=""><a href="/docs/integration/" target="_self">Key Concepts</a></li><li class=""><a href="/docs/iPaaS/" target="_self">Integration Life Cycle</a></li><li class=""><a href="/docs/howto/" target="_self">User Guides</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">howto/sftp-best-practice</h1></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="best-practices-for-using-sftp"></a><a href="#best-practices-for-using-sftp" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Best practices for using SFTP</h1>
<h2><a class="anchor" aria-hidden="true" id="which-session-factory-do-i-need"></a><a href="#which-session-factory-do-i-need" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Which session factory do I need?</h2>
<p>When occasionally retrieving or writing files to SFTP, use the <em>Default SFTP session factory</em>. When you use the <em>Default SFTP session factory</em> for every message/file a new connection will be set up. On some SFTP servers this might take up to seconds for each login, which might have impact on the performance of your flow.</p>
<p>When you need better performance (say writing multiple files in a minute, or retrieving files every minute) use the <em>Default SFTP <strong>caching</strong> session factory</em>. The <em>Default SFTP <strong>caching</strong> session factory</em> shares SFTP sessions for messages in your flow.</p>
<h2><a class="anchor" aria-hidden="true" id="do-i-have-to-set-up-a-retry-mechanism"></a><a href="#do-i-have-to-set-up-a-retry-mechanism" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Do I have to set up a retry mechanism?</h2>
<p>When writing files to SFTP it is advisable to set a retry mechanism. Find the advanced tab on your <em>SFTP outbound channel adapter</em>. Under <em>Request handler advice chain</em> add a <em>Retry Advice</em>.</p>
<h2><a class="anchor" aria-hidden="true" id="do-i-have-to-disable-use-temporary-file-name"></a><a href="#do-i-have-to-disable-use-temporary-file-name" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Do I have to disable <em>Use temporary file name</em>?</h2>
<p>This is no longer necessary. There was a bug on the SFTP servers of eMagiz Services, but this bug has been fixed. The best practice is to keep <em>Use temporary file name</em> property turned on.</p>
<h2><a class="anchor" aria-hidden="true" id="i-get-a-failed-to-list-files--items-or-a-failed-to-obtain-pooled-item-what-can-i-do"></a><a href="#i-get-a-failed-to-list-files--items-or-a-failed-to-obtain-pooled-item-what-can-i-do" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>I get a <em>Failed to list files / items</em> or a <em>Failed to obtain pooled item</em>. What can I do?</h2>
<p>This can be caused by incorrect connection settings. Check whether the correct properties have been set and whether the runtime has retrieved the latest properties.</p>
<h2><a class="anchor" aria-hidden="true" id="i-get-a-failed-to-list-files--items-a-pipe-closed-or-an-input-stream-is-closed-what-can-i-do"></a><a href="#i-get-a-failed-to-list-files--items-a-pipe-closed-or-an-input-stream-is-closed-what-can-i-do" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>I get a <em>Failed to list files / items</em>, a <em>Pipe closed</em> or an <em>input stream is closed</em>. What can I do?</h2>
<p>These notifications can be caused by a closed SFTP session due to inactivity. On the <em>Default SFTP <strong>caching</strong> session factory</em>, always set the <em>Server alive interval</em> property to 30000 (ms). This is also the default on new <em>Default SFTP <strong>caching</strong> session factory</em> components.</p>
<h2><a class="anchor" aria-hidden="true" id="i-get-a-failed-to-write-to-what-can-i-do"></a><a href="#i-get-a-failed-to-write-to-what-can-i-do" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>I get a <em>Failed to write to</em>. What can I do.</h2>
<p>Maybe the target folder does not exist and <em>Auto create directory</em> is off. It is also possible that the connection settings are incorrect. Check whether the correct properties have been set and whether the runtime has retrieved the latest properties.</p>
<h2><a class="anchor" aria-hidden="true" id="i-often-get-disconnecting-from-sftpexamplecom-port-22-and-then-a-caught-an-exception-leaving-main-loop-due-to-socket-closed-warnings"></a><a href="#i-often-get-disconnecting-from-sftpexamplecom-port-22-and-then-a-caught-an-exception-leaving-main-loop-due-to-socket-closed-warnings" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>I often get 'Disconnecting from sftp.example.com port 22' and then a 'Caught an exception, leaving main loop due to Socket closed' warnings.</h2>
<p>This can be caused by too many connections to the same server at the same time. If you have many flows connecting to the same SFTP server, make sure that the crons do not all trigger at the same time.</p>
<h2><a class="anchor" aria-hidden="true" id="i-get-a-failed-to-create-ftpclient"></a><a href="#i-get-a-failed-to-create-ftpclient" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>I get a ‘Failed to create FTPClient’</h2>
<p>SFTP, FTP and FTPS are three different remote file transfer protocols with their own <em>session factory</em> components in the eMagiz flow designer. Make sure you use the one that corresponds to the server's protocol.</p>
<h2><a class="anchor" aria-hidden="true" id="one-of-my-remote-files-is-not-picked-up-from-the-sftp-server-without-any-warning"></a><a href="#one-of-my-remote-files-is-not-picked-up-from-the-sftp-server-without-any-warning" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>One of my remote files is not picked up from the SFTP server (without any warning)</h2>
<p>The default local filter is <em>AcceptOnceFileListFilter</em>. This can be replaced by your own file list filter on the advanced tab of the <em>SFTP inbound channel adapter</em>.</p>
<p>If every day you retrieve a file with the same filename and the <em>Delete remote files</em> property is set, it is advised to use a different local filename. You can add the current timestamp for example.</p>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#which-session-factory-do-i-need">Which session factory do I need?</a></li><li><a href="#do-i-have-to-set-up-a-retry-mechanism">Do I have to set up a retry mechanism?</a></li><li><a href="#do-i-have-to-disable-use-temporary-file-name">Do I have to disable <em>Use temporary file name</em>?</a></li><li><a href="#i-get-a-failed-to-list-files--items-or-a-failed-to-obtain-pooled-item-what-can-i-do">I get a <em>Failed to list files / items</em> or a <em>Failed to obtain pooled item</em>. What can I do?</a></li><li><a href="#i-get-a-failed-to-list-files--items-a-pipe-closed-or-an-input-stream-is-closed-what-can-i-do">I get a <em>Failed to list files / items</em>, a <em>Pipe closed</em> or an <em>input stream is closed</em>. What can I do?</a></li><li><a href="#i-get-a-failed-to-write-to-what-can-i-do">I get a <em>Failed to write to</em>. What can I do.</a></li><li><a href="#i-often-get-disconnecting-from-sftpexamplecom-port-22-and-then-a-caught-an-exception-leaving-main-loop-due-to-socket-closed-warnings">I often get 'Disconnecting from sftp.example.com port 22' and then a 'Caught an exception, leaving main loop due to Socket closed' warnings.</a></li><li><a href="#i-get-a-failed-to-create-ftpclient">I get a ‘Failed to create FTPClient’</a></li><li><a href="#one-of-my-remote-files-is-not-picked-up-from-the-sftp-server-without-any-warning">One of my remote files is not picked up from the SFTP server (without any warning)</a></li></ul></nav></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '2e1804e3e0c239242d9914d98d6bf260',
                indexName: 'emagiz',
                inputSelector: '#search_input_react'
              });
            </script></body></html>