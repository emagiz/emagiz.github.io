<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>howto/upgrade-to-eMagiz5 · eMagiz Platform documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;h1&gt;&lt;a class=&quot;anchor&quot; aria-hidden=&quot;true&quot; id=&quot;how-to-upgrade-a-message-bus-completely-to-emagiz-5&quot;&gt;&lt;/a&gt;&lt;a href=&quot;#how-to-upgrade-a-message-bus-completely-to-emagiz-5&quot; aria-hidden=&quot;true&quot; class=&quot;hash-link&quot;&gt;&lt;svg class=&quot;hash-link-icon&quot; aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;How to upgrade a message bus completely to eMagiz 5&lt;/h1&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="howto/upgrade-to-eMagiz5 · eMagiz Platform documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://emagiz.github.io/"/><meta property="og:description" content="&lt;h1&gt;&lt;a class=&quot;anchor&quot; aria-hidden=&quot;true&quot; id=&quot;how-to-upgrade-a-message-bus-completely-to-emagiz-5&quot;&gt;&lt;/a&gt;&lt;a href=&quot;#how-to-upgrade-a-message-bus-completely-to-emagiz-5&quot; aria-hidden=&quot;true&quot; class=&quot;hash-link&quot;&gt;&lt;svg class=&quot;hash-link-icon&quot; aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;How to upgrade a message bus completely to eMagiz 5&lt;/h1&gt;
"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/platypus.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/platypus.png" alt="eMagiz Platform documentation"/><h2 class="headerTitleWithLogo">eMagiz Platform documentation</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Ask me something" title="Ask me something"/></li><li class=""><a href="/docs/referenceguide/" target="_self">Reference</a></li><li class=""><a href="/docs/ILM/" target="_self">General</a></li><li class=""><a href="/docs/integration/" target="_self">Concepts</a></li><li class=""><a href="/docs/iPaaS/" target="_self">Method</a></li><li class=""><a href="/docs/howto/" target="_self">How to</a></li><li class=""><a href="/docs/portal-documentation/" target="_self">Old documentation</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">howto/upgrade-to-eMagiz5</h1></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="how-to-upgrade-a-message-bus-completely-to-emagiz-5"></a><a href="#how-to-upgrade-a-message-bus-completely-to-emagiz-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How to upgrade a message bus completely to eMagiz 5</h1>
<h2><a class="anchor" aria-hidden="true" id="1-introduction"></a><a href="#1-introduction" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. Introduction</h2>
<p>This tutorial presents the possibilities of migrating a bus from eMagiz 4 to eMagiz 5.</p>
<p>The release notes of eMagiz 5 can be found <a href="https://my.emagiz.com/link/releasenote/119">here</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="2-requirements"></a><a href="#2-requirements" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Requirements</h2>
<p>In order to upgrade to eMagiz5, 4 conditions must be met:</p>
<p>2.1) Spring Integration 4: It is recommended that all flows have the value of the build number higher or equal to 32. All flows with a build number 22 or lower are not going to be able to upgrade and the ones between 22 and 32 are more errorprone. Firstly test your flows and then update them!</p>
<p>2.2) enable the Releases functionality in the deploy phase (this can be done by contacting your partner contact): you need to have this new way of deploying enabled in order to firstly make a release of the create phase containing only the flows which are currently running on production (be careful to have only what is correctly running on production) in order to have a safe eMagiz4 backup prior to the migration in case there will be any problems while upgrading to eMagiz5.</p>
<p>2.3) Java 8: the new framework works only from java 8 or higher. Java 8 is required for updating to the latest runtime version or the latest cloud template.</p>
<p>2.4.1) For on-premise environments only updating your java is not enough, you also need to install the eMagiz5 runtime. If you already have runtime version 5, a reinstall is not necessary. Start updating your runtimes now by downloading the latest version of the runtime from the eMagiz iPaaS if you have on-premise installations.</p>
<p>2.4.2) For environments running in cloud you just need to update to the newest template (at least R4 for AWS Cloud or instance template &gt;= 21 for Root Cloud).</p>
<p><strong>In order to proceed further with the migration, a validation from your partner contact is needed.</strong></p>
<h2><a class="anchor" aria-hidden="true" id="3-preparation-steps"></a><a href="#3-preparation-steps" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Preparation steps</h2>
<p>3.1) <strong>Using the <a href="https://github.com/emagiz/emdocs/blob/master/howto/deploy-releases.md">releases documentation</a></strong> create a copy of your latest Create phase for every environment(testing, acceptance and production) which can be considered the eMagiz 4 backup of this process so rename them accordingly(e.g. eMagiz4 backup). Make sure that each backup contains the versions of the flows that are currently running on that environment and only the flows that are completely running on production (both the onramp and its connector flows are running). It is recommended that the acceptance and production environments have the same flows running. It can be done by using the point 2.4 from <a href="https://github.com/emagiz/emdocs/blob/master/howto/deploy-releases.md">this documentation</a></p>
<p>3.2) For on premise connectors make sure that the firewall has the amqp port 8443 opened</p>
<p>3.3) <strong>Go to</strong> Create -&gt; Settings -&gt; Message bus settings and copy the technical name of the bus. Then go to Deploy -&gt; Properties and create 2 (or 4 if you have a failover bus) new properties for the host and port of the jms server(s). They should all be global, of type string and have the following content:</p>
<p>3.3.1) name: technical name + “.amqp01.host”, value: amqp01.cloud000x.emagizcloud.com (in order to replace the ‘x’ in this value you need to contact your partner contact)</p>
<p>3.3.2) name: technical name + “.amqp01.port”, value: 8443</p>
<p>3.3.3) (ONLY IF YOU HAVE A FAILOVER BUS) name: technical name + “.amqp01b1.host”, value: amqp01b1.cloud000x.emagizcloud.com (in order to replace the ‘x’ in this value you need to contact your partner contact)</p>
<p>3.3.4) (ONLY IF YOU HAVE A FAILOVER BUS) name: technical name + “.amqp01b1.port”, value: 8444</p>
<p>3.4) BE AWARE: If you ever changed the names of the connection factories, you should change them back to follow the convention('in-vm-connection-caching', 'in-vm-connection-plain') because otherwise the migration wizard will encounter problems.</p>
<p>3.5) <strong>Go to</strong> Deploy -&gt; Properties and modify the data.dir property, you need to replace &quot;hornetQ&quot; with &quot;artemis&quot; (e.g. &quot;/efs/data/<strong>hornetq</strong>/jms01&quot; to &quot;/efs/data/<strong>artemis</strong>/jms01&quot;)</p>
<p>3.6) <strong>Go to</strong> Create -&gt; Settings -&gt; AMQP -&gt; Upgrade to AMQP wizard. It is recommended to upgrade the bus by using the method 4.1. If it does not succeed, then it is recommended to make use of the method from 4.2.</p>
<p>3.7) For environments where you have enabled debugging, <strong>go to</strong> Deploy -&gt; Properties and create property &quot;debug.channel-pattern&quot; with value &quot;<em>.</em>&quot; and property &quot;debug.bridge-poller-interval&quot; with value &quot;0/5 * * * * *&quot;. The first value will make the debugger only intercept channels which have a channel that matches the channel pattern, in this way excluding the debugger channels. The second value will make that the debugger messages are polled once every 5 seconds. For disabling the debugger functionality, set the value           &quot;(disabled)&quot; to the &quot;debug.channel-pattern&quot; property and the value &quot;0 0 0 24 12 2&quot;  to the &quot;bridge-poller-interval&quot; property. Since there is no way to disable the polling of the debugger messages, the above expression will ensure that it is only triggered at midnight whenever the 24th of December is a Tuesday.</p>
<p>BEFORE PROCEEDING WITH THE NEXT STEPS: be aware that there is a development freeze period until the migration process is finished (during the step 4 of the migration) because the wizard is editing all the flows of the bus and has a lock on them.</p>
<h2><a class="anchor" aria-hidden="true" id="4the-steps-for-migrating-to-emagiz-5"></a><a href="#4the-steps-for-migrating-to-emagiz-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4.The steps for migrating to eMagiz 5:</h2>
<p><strong>Note</strong> In case you do <strong>not</strong> want to upgrade all your connectors at once, pursue points 4.2.1) and 4.2.2) and then <strong>go to</strong> the two data grids below the wizard and upgrade all the connectors you want by selecting them one by one and press &quot;Upgrade container&quot; for each of them.</p>
<h3><a class="anchor" aria-hidden="true" id="41-using-the-upgrade-complete-bus-at-once-button"></a><a href="#41-using-the-upgrade-complete-bus-at-once-button" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4.1 Using the &quot;upgrade complete bus at once&quot; button</h3>
<p>4.1.1) <strong>Go to</strong> Deploy -&gt; Releases and for each environment create a release based on the backup created during 3.1) named &quot;eMagiz 5 migration&quot;.</p>
<p>4.1.2) <strong>Go to</strong> Create -&gt; Settings -&gt; AMQP -&gt; Upgrade to AMQP wizard. Press the &quot;upgrade complete bus at once&quot; button. It might take a while until it finishes upgrading every flow from the bus.  If it does not succeed, try again using the method from 4.2, starting with the point 4.2.1).</p>
<h3><a class="anchor" aria-hidden="true" id="42-using-the-step-by-step-wizard"></a><a href="#42-using-the-step-by-step-wizard" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4.2 Using the &quot;step by step&quot; wizard</h3>
<p>4.2.1) <strong>Press</strong> the button &quot;Step 1: Upgrade JMS server(s)&quot;, and wait for the process to finish.</p>
<p>4.2.2) <strong>Press</strong> the button &quot;Step 2: Upgrade process container(s)&quot; and wait for the process to finish.</p>
<p>4.2.3) <strong>Press</strong> the button &quot;Step 3: Upgrade connectors&quot; and wait for the process to finish.</p>
<p>4.2.4) <strong>Press</strong> the button &quot;Step 4: Remove backward compatibility of JMS server&quot; and wait for the process to finish.</p>
<h2><a class="anchor" aria-hidden="true" id="5the-deployment-of-emagiz5"></a><a href="#5the-deployment-of-emagiz5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5.The deployment of eMagiz5</h2>
<p>5.1) <strong>Go to</strong> Deploy -&gt; Releases -&gt; <a href="https://github.com/emagiz/emdocs/blob/master/howto/deploy-releases.md">Details</a> of the &quot;eMagiz 5 migration&quot; release -&gt; Advanced actions -&gt; Update to latest versions. Afterwards, in the same screen press &quot;Set as active&quot;.</p>
<p>5.2) <strong>Go to</strong> Deploy -&gt; Releases and for the active release press the install button and further install all the new versions of the flows displayed. After it finishes, in order to make sure that all flows were installed, press the install button again and make sure that there are no flows left uninstalled. Another way of checking would be to <strong>go to</strong> Deploy -&gt; Runtime dashboard and press &quot;Check release state&quot;.</p>
<p>5.3) <strong>Go to</strong> each container in the runtime dashboard and start the flow(s) in the following order:</p>
<p>5.3.1) If you have a failover bus: Firstly start the live JMS server, amqp01, and secondly the back up server, amqp01b1. In all other cases just start the jms server before any other flows.</p>
<p>5.3.2) Container(s): if you have multiple containers, you can use any order.</p>
<p>5.3.3) Connector(s): if you have multiple connectors, firstly start the exit connectors and then start the entry connectors.If you do it the other way around, the queues of the exit connectors start being filled up and the bus will have problems.</p>
<p>5.4) <strong>Go to</strong> Runtime dashboard and check if every flow is still active.</p>
<p><strong>Note:</strong> <strong>It is recommended</strong> that the migration of the eMagiz Mendix Connector(s) to be done at last because it needs to be done 'one connector at a time' and depending on the number of Mendix systems that the bus contains, it might take quite some time.</p>
<h2><a class="anchor" aria-hidden="true" id="health-checks-test-cases"></a><a href="#health-checks-test-cases" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Health checks (test cases)</h2>
<p>Here are some bus health checks that you should do after the migration is finished and every flow seems to be running in the runtime dashboard:</p>
<ul>
<li><p><strong>Test the most ‘critical-integrations-chains’ of your bus. After the migration everything should work as before without the need of doing any manual change.</strong></p></li>
<li><p><strong>Test any flow where the user made any change related to the HornetQ JMS settings OR customised the autogenerated flows(jms server, container infra, connector infra) OR the autogenerated part of the flows(onramp, offramp, entry connector, exit connector, routing flow, error flow).</strong></p></li>
<li><p><strong>Test all the flows which contain unusual structures such as an entry/exit connector and combined entry connectors</strong></p></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="large-message-issues"></a><a href="#large-message-issues" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Large message issues</h4>
<p>This test is only applicable if you know that one of the systems in the bus is sending large messages. When is a message considered large?</p>
<ul>
<li>when sending a message from a HornetQ client, a message is considered to be <strong>large</strong> when it exceeds the default value of <strong>100KB</strong></li>
<li>when sending a message from an AMQP client, a message is considered to be <strong>large</strong> when it exceeds the default value of <strong>500KB</strong></li>
</ul>
<p>The issue with large messages happens when the consumer of the destination queue stops processing the messages and they start to pile up on it. No errors or warnings appear on the log. The issue has been addressed and should not occur anymore because an auto recovery mechanism has been introduced in eMagiz since build 36 to avoid this problem.</p>
<p>However, you should test to make sure that the default settings of the auto recovery mechanism work correctly in your use case. The auto recovery mechanism is configured to check every 60 seconds if a message takes longer than 4 minutes to be processed in asynchronous flows and 1 minute for synchronous flows. When that behavior is detected, the connection is reset and afterwards messages are processed again.</p>
<p>You can identify an auto recovery action by checking searching the log for Auto-recovery.</p>
<p>
  <img width="432" height="229" src="../../img/howto/artemis-server-settings.png"> 
</p>
<p>If a change in the autorecovery mechanism settings are needed, you can do it in the advanced tab of the artemis-server support object of the JMS server flow of the bus. You can find more information in the helptext about the different configurations.</p>
<p >
 <img width="454" height="250" src="../../img/howto/artemis-server.png">
</p>
<h4><a class="anchor" aria-hidden="true" id="manually-added-queues"></a><a href="#manually-added-queues" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Manually added queues</h4>
<ul>
<li>when having integrations which contain <strong>manually added queues</strong> within the <strong>jms server flow</strong> they should be checked.</li>
<li>usually used in entry flows which split messages. After the migration has ended, the manually added queues will be replaced with the message bridge and the h2 message store which might change the result delivered by the flow.</li>
</ul>
<p>Note that Artemis does not have the JMS queue configurations settings section as HornetQ component anymore. In Artemis a queue is linked to an address. In eMagiz we configured that queues are created automatically and deleted automatically when needed. That means that you don’t need to configure anything to make this work. Your manually added queue will be created when a message is sent to that destination or a consumer tries to connect to that queue. On the other hand, the queue will be deleted when they have both 0 consumers and 0 messages. You will notice that the queue is deleted when you see in the logging “No Dead Letter Address configured for queue”.</p>
<h4><a class="anchor" aria-hidden="true" id="special-hornetq-headers"></a><a href="#special-hornetq-headers" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Special HornetQ headers</h4>
<ul>
<li>usually used for advanced messaging behavior</li>
<li>can be recognized by using the prefix <code>_HQ_</code></li>
<li>it will not work anymore because it needs to have the prefix previously mentioned adapted to AMQP (it can be looked up on the internet).</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="emagiz-mendix-connector-migration-steps"></a><a href="#emagiz-mendix-connector-migration-steps" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>eMagiz Mendix Connector Migration steps</h2>
<ol>
<li><p><strong>Go to</strong> Deploy -&gt; On premises -&gt; Runtime downloads and download the eMagiz Mendix connector with the eMagiz version emc 3.0.0. Be careful, this new version of the eMagiz Mendix Connector is <strong>not</strong> compatible with eMagiz4.</p></li>
<li><p>In case the standard configuration of the connector infra has been modified, it should be checked to make sure the desired values are still in place.</p></li>
<li><p>Next part is about upgrading the eMagiz Mendix Connector of the Mendix project. In order to do that, you can use the following <a href="/docs/howto/upgrade-eMagizMendixConnector">documentation</a>. The eMagiz Mendix Connector version you need to download is 3.0.0. <strong>It is mandatory</strong> to do a cleanup of the project directory after finishing upgrading the eMagiz Mendix Connector.</p></li>
<li><p><strong>Go to</strong> Deploy -&gt;  Releases, press install for the release you created. In the popup page that opens, download the &quot;.emc&quot; package needed for deploying the eMagiz Mendix connector of the Mendix project where you have just upgraded the eMagiz Mendix connector.</p>
<p><strong>Note:</strong>  when it comes to the deploy packages, the versions of the connector infra and the request handler of a system MUST have the build number 3 (e.g. x.y.z.3) while the one of the connector (entry or exit flow) can be 2 or 3 (e.g. x.y.z.2 or x.y.z.3).</p></li>
<li><p><strong>Run</strong> the Mendix project</p></li>
<li><p><strong>Go to</strong> the eMagiz Mendix connector tab</p></li>
<li><p><strong>Press</strong> upload and load there the file you downloaded from the eMagiz iPaas at step 3.</p></li>
<li><p><strong>Press</strong> save to return in the eMagiz Mendix connector tab.</p></li>
<li><p><strong>Start</strong> the flows in the following order:</p>
<p>9.1) The connector infra</p>
<p>9.2) The request handler</p>
<p>9.3) If you have multiple connector flows, firstly start the exit connectors and then the entry connectors. If you do it the other way around, the queues of the exit connectors start being filled up and the bus will have problems.</p>
<p>9.4) In case your connector does not work check the <a href="/docs/howto/upgrade-to-eMagiz5#emc-health-checks">eMagiz Mendix Connector health checks</a></p></li>
</ol>
<h3><a class="anchor" aria-hidden="true" id="emagiz-mendix-connector-health-checks"></a><a href="#emagiz-mendix-connector-health-checks" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>eMagiz Mendix Connector Health checks</h3>
<ul>
<li>If the communication between the eMagiz Mendix Connector and the eMagiz iPaaS does not work it might be the case that you have custom keystore/truststore used by the eMagiz Mendix Connector, so you should try downloading the new autogenerated ones (Create -&gt; Resources) and put them in the resources folder of the Mendix Connector.</li>
</ul>
 <!--- Feedback items left to be fixed:
         - delete 5.2.1 and 5.2.2 (can be seen in versioning history) - done
         - If you have custom keystore/truststore used by the Mendix Connector, you need to download the new autogenerated ones (Create -> Resources) and put them in the resources folder of the Mendix Connector. do something about this info  - done
         - consistency in naming (eMagiz) - done
         - detail more step 4 of emc migration - done
         - mention the cleanup tool as mandatory - done
         - explain why the emc migration is last - done
--->
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#1-introduction">1. Introduction</a></li><li><a href="#2-requirements">2. Requirements</a></li><li><a href="#3-preparation-steps">3. Preparation steps</a></li><li><a href="#4the-steps-for-migrating-to-emagiz-5">4.The steps for migrating to eMagiz 5:</a><ul class="toc-headings"><li><a href="#41-using-the-upgrade-complete-bus-at-once-button">4.1 Using the &quot;upgrade complete bus at once&quot; button</a></li><li><a href="#42-using-the-step-by-step-wizard">4.2 Using the &quot;step by step&quot; wizard</a></li></ul></li><li><a href="#5the-deployment-of-emagiz5">5.The deployment of eMagiz5</a></li><li><a href="#health-checks-test-cases">Health checks (test cases)</a></li><li><a href="#emagiz-mendix-connector-migration-steps">eMagiz Mendix Connector Migration steps</a><ul class="toc-headings"><li><a href="#emagiz-mendix-connector-health-checks">eMagiz Mendix Connector Health checks</a></li></ul></li></ul></nav></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '2e1804e3e0c239242d9914d98d6bf260',
                indexName: 'emagiz',
                inputSelector: '#search_input_react'
              });
            </script></body></html>